# Calcium_model_explaining_refractory
This repository contains the code and data for an astrocyte intracellular calcium signaling model that explains refractory period. 

The folder functions/ contains the MATLAB implementation of the model and the code for parameter optimization by genetic algorithm. They have been divided into several sub-folders based on their categories. The model, described by a system of ordinary differential equations, was simulated using customly implemented 4th order Runge-Kutta method. Details of the simulation loop can be found in run.m in functions/.

The folder Data/ contains the preprocessed experimental data we used in model fitting. In Data/, there are subfolders for four mice which participated in the experiment. Within a folder for a mouse, there are subfolders for recordings from diffrent recording locations on its motor cortex. Within the folder for a recording location, there are specific calcium recording data stored in subfolders. Within each subfolder of calcium recording, there is a MAT file that contain the real calcium signal extracted from calcium recording video (attribute name: avg_roi_temp_down), the mouse's run velocity time series (attribute name: velocity), and a table containing the visual stimuli and reward information (attribute name: TT). Besides the MAT file, there are also pre-computed inputs to the model in case you need a faster computation.

**To run a demo, please download this repository and open the main_simulation.m by MATLAB.** In main_simulation.m, you can set the mouse's name, recording location, and recording number, according to the contents in Data/ folder, and then do a simulation on the calcium signaling and compare with the experimentally measured calcium signal.

**To try the parameter optimization by genetic algorithm, open the main_param_opt.m by MATLAB.** In main_param_opt.m, you need to specify a save_path to store the train-test split and five-fold cross validation information, and the folders that store the intermediate results of the genetic algorithm. You may also set pop_size, tournament_size, max_generations, mutation_rate by yourself. For your reference, the computing time for one generation of genetic algorithm on a Ubuntu server with Intel(R) Xeon(R) Platinum 8268 CPU @ 2.90GHz is around 9000s, with pop_size=40, tournament_size=15, and 28 recordings used for training.
